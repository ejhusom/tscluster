schema: '2.0'
stages:
  profile:
    cmd: python3 src/profiling.py assets/data/raw/
    deps:
    - path: assets/data/raw
      md5: 8099e8474cc1419c4c663d696b1817d2.dir
      size: 1526226423
      nfiles: 7
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/profile.yaml
      md5: 317b4d9674ca46acc17a1e8da4fa604e
      size: 3918
    - path: src/profiling.py
      md5: a0de3f466aff6d4d8e2e19269f5a9f15
      size: 1689
    params:
      params.yaml:
        profile.dataset: split_by_pn
    outs:
    - path: assets/profile
      md5: 2590466b92c1f5ac2bc51c231d6fde1f.dir
      size: 940152372
      nfiles: 2
  clean:
    cmd: python3 src/clean.py assets/data/raw/
    deps:
    - path: assets/data/raw
      md5: 8099e8474cc1419c4c663d696b1817d2.dir
      size: 1526226423
      nfiles: 7
    - path: assets/profile
      md5: 2590466b92c1f5ac2bc51c231d6fde1f.dir
      size: 940152372
      nfiles: 2
    - path: src/clean.py
      md5: 2186cd1ab155cfd9984869777157ee1e
      size: 4477
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    params:
      params.yaml:
        clean.combine_files: false
        clean.correlation_metric: pearson
        clean.input_max_correlation_threshold: 1.0
        clean.percentage_zeros_threshold: 1.0
    outs:
    - path: assets/data/cleaned
      md5: 6809278fd3e100fe1eac8edead187af7.dir
      size: 473377558
      nfiles: 2
  featurize:
    cmd: python3 src/featurize.py assets/data/cleaned/
    deps:
    - path: assets/data/cleaned
      md5: 6809278fd3e100fe1eac8edead187af7.dir
      size: 473377558
      nfiles: 2
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/featurize.py
      md5: 50b2a51553f59d01b87fc9395fe9a7e7
      size: 7931
    params:
      params.yaml:
        featurize.add_rolling_features: true
        featurize.features:
        - Spindle_Torque
        featurize.remove_features:
        - Spindle_Torque
        featurize.rolling_window_size: 4400
    outs:
    - path: assets/data/featurized
      md5: fa60e2d22a235f12fde9d92a5e14c728.dir
      size: 358032008
      nfiles: 2
    - path: assets/data/input_columns.csv
      md5: cf93abedb45523d885baa6e89376dd61
      size: 344
  scale:
    cmd: python3 src/scale.py assets/data/featurized/
    deps:
    - path: assets/data/featurized
      md5: fa60e2d22a235f12fde9d92a5e14c728.dir
      size: 358032008
      nfiles: 2
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/scale.py
      md5: 76df14bd9669b9a33f16f193a10e4f7e
      size: 2020
    params:
      params.yaml:
        scale.input:
    outs:
    - path: assets/data/scaled
      md5: 17d49e02903000039e69470b3bde480c.dir
      size: 358032008
      nfiles: 2
  sequentialize:
    cmd: python3 src/sequentialize.py assets/data/scaled/
    deps:
    - path: assets/data/scaled
      md5: 17d49e02903000039e69470b3bde480c.dir
      size: 358032008
      nfiles: 2
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/preprocess_utils.py
      md5: 22fc0c6db31b2d7f3dc11c7d7444dddd
      size: 11358
    - path: src/sequentialize.py
      md5: f02a7ed858ed67356eccc2c889d9a79d
      size: 1633
    params:
      params.yaml:
        sequentialize.overlap: 0
        sequentialize.shuffle_samples: false
        sequentialize.window_size: 1
        train.learning_method: hierarchical
    outs:
    - path: assets/data/sequentialized
      md5: e0b3fa02da8a0945419659bfd608695b.dir
      size: 358032264
      nfiles: 2
  combine:
    cmd: python3 src/combine.py assets/data/sequentialized/
    deps:
    - path: assets/data/sequentialized
      md5: e0b3fa02da8a0945419659bfd608695b.dir
      size: 358032264
      nfiles: 2
    - path: src/combine.py
      md5: 2d47b34fc0cbf4b68ea87e0a84811132
      size: 835
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    outs:
    - path: assets/data/combined
      md5: 22968955659486ebf2471da08bb3313b.dir
      size: 358032008
      nfiles: 1
  train:
    cmd: python3 src/train.py assets/data/combined/X.npz
    deps:
    - path: assets/data/combined
      md5: 22968955659486ebf2471da08bb3313b.dir
      size: 358032008
      nfiles: 1
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/train.py
      md5: 91d37b12033b475ec86f7adf9e20d339
      size: 1695
    params:
      params.yaml:
        train.learning_method: kmeans
        train.n_clusters: 2
    outs:
    - path: assets/models
      md5: 953ad4be2109966904bb61ad9c8e5e28.dir
      size: 13771376
      nfiles: 1
  evaluate:
    cmd: python3 src/visualize.py assets/models/model.h5 assets/data/combined/X.npz
    deps:
    - path: assets/data/combined
      md5: 446adcd8b515c5855dbe4d8c6813f91f.dir
      size: 1188256
      nfiles: 1
    - path: assets/models/model.h5
      md5: 833ce3fcab1589e67b4b6274eb57601e
      size: 1208286
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/visualize.py
      md5: b218fa5b63910fe034195d57b9b6217a
      size: 772
  visualize:
    cmd: python3 src/visualize.py assets/models/model.h5 assets/data/combined/X.npz
    deps:
    - path: assets/data/combined
      md5: 22968955659486ebf2471da08bb3313b.dir
      size: 358032008
      nfiles: 1
    - path: assets/models/model.h5
      md5: a9763f455cbb3caed876e5066b0733d4
      size: 13771376
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/visualize.py
      md5: 2c88aa75aac720b433b2a58d95945846
      size: 3893
